function [iiMax, nP, ZTolerance, YPattern, muFactor] = SH_10_0_349B()
% ------------------------------------------------------------------------------
% 2023-01-21 Wojciech Bruzda; name[at]uj.edu.pl : name = w.bruzda
%            https://chaos.if.uj.edu.pl/~karol/hadamard/
%            https://github.com/matrix-toolbox/
% ------------------------------------------------------------------------------
% Symmetric CHM of order N = 10 with generic d = 0 and #L = 349.
% Slower convergence in comparison with its alt. version: "SH_10_0_349A.m".
% ------------------------------------------------------------------------------
% Possible solutions:
% ..............................................................................
% s1) non-BH with d = 0 and #L = 349
%
%  p(1) = -0.806587118601479 + 0.591115234202405i
%  p(2) = +0.059402956556808 - 0.998234085148524i
%  p(3) = -0.499377323379457 + 0.866384607950977i
%  p(4) = +0.999959630681673 - 0.008985377397323i
%  p(5) = -0.926210473012594 - 0.377006843017188i
%  p(6) = +0.896885016295949 - 0.442263798590632i
%  p(7) = +0.976132186250972 + 0.217177243202175i
%  p(8) = +0.642818241059697 - 0.766018739301407i
%  p(9) = -0.518845624274871 - 0.854867953645953i
% p(10) = +0.999541531583021 + 0.030277493962828i
% p(11) = -0.402430171199432 + 0.915450685350334i
% p(12) = -0.984267534064696 - 0.176684525033188i
% p(13) = -0.888341098406949 + 0.459184160093894i
% p(14) = +0.016353544472019 - 0.999866271849992i
% p(15) = -0.761622016663565 + 0.648021530300749i
% p(16) = -0.608024208209892 + 0.793918485885506i
% p(17) = +0.989305752805790 + 0.145856530417289i
% p(18) = +0.999072042042862 - 0.043070347204374i
% p(19) = -0.910696124212091 - 0.413076953296933i
% p(20) = -0.793816406195755 - 0.608157474059520i
% p(21) = +0.776428657725127 - 0.630205156645959i
% p(22) = +0.022958799331118 + 0.999736412027327i
%
% or
%
%  p(1) = +0.999916466983275 - 0.012925132714398i
%  p(2) = +0.331212246247407 - 0.943556277036906i
%  p(3) = +0.010403156507039 + 0.999945885703166i
%  p(4) = +0.956287503198651 - 0.292428130018456i
%  p(5) = -0.455107052107008 + 0.890436730555557i
%  p(6) = +0.047881806505524 - 0.998853008508143i
%  p(7) = -0.975693097694963 - 0.219141459131783i
%  p(8) = +0.870594414232519 + 0.492001388115051i
%  p(9) = -0.796512358324048 - 0.604622248215415i
% p(10) = +0.746912166024584 + 0.664922714489785i
% p(11) = -0.125134378742652 - 0.992139802274201i
% p(12) = -0.975233426464704 + 0.221178127096496i
% p(13) = -0.959054443518156 + 0.283221775942600i
% p(14) = +0.075705612903850 - 0.997130212246551i
% p(15) = +0.693218481709848 - 0.720727505105705i
% p(16) = -0.346913574385127 + 0.937897100916372i
% p(17) = -0.841365645713968 + 0.540466326622037i
% p(18) = +0.965923096891802 - 0.258829231136962i
% p(19) = -0.997252253659552 + 0.074080649099109i
% p(20) = +0.903233513030162 + 0.429149415634220i
% p(21) = -0.424680564836617 - 0.905343259681129i
% p(22) = +0.961827724717156 + 0.273655674096881i
%
% or (original Sinkhorn's output)
%
% a =  0.911380967642390 + 0.411563763977370i
% b =  0.261328642143527 - 0.965249885156906i
% c =  0.902041190886301 - 0.431649962289380i
% d = -0.989262848557025 + 0.146147242412714i
% e =  0.598339389580414 - 0.801242769001092i
% f = -0.988067784687424 - 0.154019650898471i
% g = -0.997876376206585 - 0.065136301774157i
% h = -0.012911034707584 + 0.999916649117705i
% j = -0.380132854452252 + 0.924931896393450i
% k = -0.033429650936428 + 0.999441073019449i
% m = -0.232912022391624 - 0.972497809676425i
% n =  0.525289498392687 - 0.850923582278902i
% o = -0.695981164804503 - 0.718060038045126i
% p = -0.996785949737597 + 0.080110988046067i
% q = -0.831410006417572 - 0.555659429172882i
% r =  0.316279497306851 + 0.948666052719989i
% s =  0.973627822310135 + 0.228142200444423i
% t = -0.337815840763924 - 0.941212227783385i
% u = -0.681097798017478 - 0.732192453891559i
% v = -0.511909285605402 - 0.859039512077860i
% w =  0.092973848717618 + 0.995668551002106i
% x = -0.989055298513812 + 0.147545303150437i
% ..............................................................................
% s2) BH(10, 12) with d = 9 and #L = 12 ---> see BH_10_9_12B.m
% 
%     Y = exp(2j*pi*[
%         0  0  0  0  0  0  0  0  0  0;
%         0  6  5  3  9 11  9  5  3 11;
%         0  5 11  4  6  2  2  8 10  8;
%         0  3  4  6  0 10  6 10  9  4;
%         0  9  6  0  0  6  3  6 12  6;
%         0 11  2 10  6  2  8  8  4  5;
%         0  9  2  6  3  8 12  2  6  8;
%         0  5  8 10  6  8  2 11  4  2;
%         0  3 10  9 12  4  6  4  6 10;
%         0 11  8  4  6  5  8  2 10  2;
%     ]/12;
% .............................................................................
% s3) 1-parameter family with generic d = 9 and #L = 20 ---> see SH_10_9_20.m
% .............................................................................
% s4) -----------------------------------------------------> see SH_10_0_9B.m
% ------------------------------------------------------------------------------

    iiMax = 40000;
    nP = 22;
    ZTolerance = 6e-13;
    YPattern = @pattern;
    muFactor = 0.001;
end

function Y = pattern(p)
    x1 = -(1+p(1)+p(2)+p(3)+p(4)+p(14)/p(16)+p(5)+p(6)+p(7));
    x2 = -(1+p(1)+p(8)+p(9)+p(10)+p(14)/p(17)+p(11)+p(6)/p(5)+p(12));
    x3 = -(1+p(2)+p(8)+p(3)*p(14)/p(6)+p(13)+p(14)+p(15)+p(16)+p(17));
    x4 = -(1+p(4)+p(10)+p(13)+p(9)+p(14)/p(13)+p(19)+p(6)/p(4)+p(20));
    x5 = -(1+p(14)/p(16)+p(14)/p(17)+p(14)+p(18)+p(14)/p(13)+p(21)+p(6)/p(3)+p(14)/p(15));
    x6 = -(1+p(5)+p(11)+p(15)+p(9)+p(19)+p(21)+p(6)/p(7)+p(22));
    x7 = -(1+p(7)+p(12)+p(17)+p(9)+p(20)+p(14)/p(15)+p(22)+p(6)/p(1));

    Y = [
        1 1           1           1               1               1           1           1         1                1           ;
        1 x1          p(1)        p(2)            p(3)            p(4)        p(14)/p(16) p(5)      p(6)             p(7)        ;
        1 p(1)        x2          p(8)            p(9)            p(10)       p(14)/p(17) p(11)     p(6)/p(5)        p(12)       ;
        1 p(2)        p(8)        x3              p(3)*p(14)/p(6) p(13)       p(14)       p(15)     p(16)            p(17)       ;
        1 p(3)        p(9)        p(3)*p(14)/p(6) p(9)^2          p(9)        p(18)       p(9)      p(6)/p(2)        p(9)        ;
        1 p(4)        p(10)       p(13)           p(9)            x4          p(14)/p(13) p(19)     p(6)/p(4)        p(20)       ;
        1 p(14)/p(16) p(14)/p(17) p(14)           p(18)           p(14)/p(13) x5          p(21)     p(6)/p(3)        p(14)/p(15) ;
        1 p(5)        p(11)       p(15)           p(9)            p(19)       p(21)       x6        p(6)/p(7)        p(22)       ;
        1 p(6)        p(6)/p(5)   p(16)           p(6)/p(2)       p(6)/p(4)   p(6)/p(3)   p(6)/p(7) p(16)*p(6)/p(14) p(6)/p(1)   ;
        1 p(7)        p(12)       p(17)           p(9)            p(20)       p(14)/p(15) p(22)     p(6)/p(1)        x7          ;
    ];
end

