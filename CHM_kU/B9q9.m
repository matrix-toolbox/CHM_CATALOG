function B = B9q9(j)
% ------------------------------------------------------------------------------
% 2022-09-19 Wojciech Bruzda; name[at]uj.edu.pl : name = w.bruzda
%            https://chaos.if.uj.edu.pl/~karol/hadamard/
%            https://github.com/matrix-toolbox/
% ------------------------------------------------------------------------------
% Taken from Butson Home;
% https://wiki.aalto.fi/display/Butson/Matrices+up+to+monomial+equivalence
% ------------------------------------------------------------------------------

    BH{1}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 0 6 3;0 6 3 3 0 6 6 3 0;0 6 3 6 3 0 3 0 6];
    BH{2}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 1 7 4;0 6 3 3 0 6 7 4 1;0 6 3 6 3 0 4 1 7];
    BH{3}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 2 8 5;0 6 3 3 0 6 8 5 2;0 6 3 6 3 0 5 2 8];
    BH{4}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 3 0 6;0 6 3 3 0 6 0 6 3;0 6 3 6 3 0 6 3 0];
    BH{5}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 4 1 7;0 6 3 3 0 6 1 7 4;0 6 3 6 3 0 7 4 1];
    BH{6}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 5 2 8;0 6 3 3 0 6 2 8 5;0 6 3 6 3 0 8 5 2];
    BH{7}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 6 3 0;0 6 3 3 0 6 3 0 6;0 6 3 6 3 0 0 6 3];
    BH{8}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 7 4 1;0 6 3 3 0 6 4 1 7;0 6 3 6 3 0 1 7 4];
    BH{9}  = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 0 6 3 8 5 2;0 6 3 3 0 6 5 2 8;0 6 3 6 3 0 2 8 5];
    BH{10} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 0 3 6;0 3 6 3 6 0 6 0 3;0 3 6 6 0 3 3 6 0;0 6 3 1 7 4 2 8 5;0 6 3 4 1 7 8 5 2;0 6 3 7 4 1 5 2 8];
    BH{11} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 0 6 3 2 8 5;0 6 3 3 0 6 8 5 2;0 6 3 6 3 0 5 2 8];
    BH{12} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 0 6 3;0 6 3 4 1 7 6 3 0;0 6 3 7 4 1 3 0 6];
    BH{13} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 1 7 4;0 6 3 4 1 7 7 4 1;0 6 3 7 4 1 4 1 7];
    BH{14} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 2 8 5;0 6 3 4 1 7 8 5 2;0 6 3 7 4 1 5 2 8];
    BH{15} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 3 0 6;0 6 3 4 1 7 0 6 3;0 6 3 7 4 1 6 3 0];
    BH{16} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 4 1 7;0 6 3 4 1 7 1 7 4;0 6 3 7 4 1 7 4 1];
    BH{17} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 5 2 8;0 6 3 4 1 7 2 8 5;0 6 3 7 4 1 8 5 2];
    BH{18} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 6 3 0;0 6 3 4 1 7 3 0 6;0 6 3 7 4 1 0 6 3];
    BH{19} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 7 4 1;0 6 3 4 1 7 4 1 7;0 6 3 7 4 1 1 7 4];
    BH{20} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 0 3 6 1 4 7;0 3 6 3 6 0 7 1 4;0 3 6 6 0 3 4 7 1;0 6 3 1 7 4 8 5 2;0 6 3 4 1 7 5 2 8;0 6 3 7 4 1 2 8 5];
    BH{21} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 1 4 7 2 5 8;0 3 6 4 7 1 8 2 5;0 3 6 7 1 4 5 8 2;0 6 3 2 8 5 1 7 4;0 6 3 5 2 8 7 4 1;0 6 3 8 5 2 4 1 7];
    BH{22} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 1 4 7 2 5 8;0 3 6 4 7 1 8 2 5;0 3 6 7 1 4 5 8 2;0 6 3 2 8 5 4 1 7;0 6 3 5 2 8 1 7 4;0 6 3 8 5 2 7 4 1];
    BH{23} = [0 0 0 0 0 0 0 0 0;0 0 0 3 3 3 6 6 6;0 0 0 6 6 6 3 3 3;0 3 6 1 4 7 2 5 8;0 3 6 4 7 1 8 2 5;0 3 6 7 1 4 5 8 2;0 6 3 2 8 5 7 4 1;0 6 3 5 2 8 4 1 7;0 6 3 8 5 2 1 7 4];

    MAX_BH = size(BH, 2);
    if j > MAX_BH
        error("Index out of scope! Must be in range 1 .. %d", MAX_BH);
    else
        B = exp(2j * pi * BH{j} / 9);
    end

end

% c1=round(log(D1'*X*D2')/2/pi/1j*9)
% c2=round(log(B)/2/pi/1j*9)

% mod(round(log(D1'*X*D2')/2/pi/1j*9)+9,9)

% diag(mod(angle(D1)+2*pi,2*pi))'/pi/2
% p1 % ==

